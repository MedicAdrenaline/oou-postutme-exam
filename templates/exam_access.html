<form id="examForm" action="{{ url_for('exam_access') }}" method="POST">
    {{ csrf_token() }}  <!-- If you're using Flask-WTF -->

    <label for="pin_code">Enter your PIN:</label>
    <input type="text" name="pin_code" required>
    
    <button type="submit">Start Exam</button>
</form>

<script>
  // Generate and store a unique device ID if it doesn't already exist
  if (!localStorage.getItem("device_id")) {
      localStorage.setItem("device_id", self.crypto.randomUUID());
  }

  // Log the device_id to the console to make sure it's generated
  console.log("Generated Device ID:", localStorage.getItem("device_id"));

  // Add device_id to form on submit
  document.getElementById("examForm").addEventListener("submit", function(e) {
      // Create a hidden input for the device_id
      const input = document.createElement("input");
      input.type = "hidden";
      input.name = "device_id";
      input.value = localStorage.getItem("device_id");

      // Append the hidden input to the form
      this.appendChild(input);

      // Log the device_id being added to the form
      console.log("Form Device ID added:", input.value);
  });
</script>